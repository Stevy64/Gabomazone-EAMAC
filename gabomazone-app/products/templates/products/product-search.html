{% extends 'base.html' %}
{% load static %}

{%block body%}
<!-- ===== Product Search Page FLAVORIZ Design ===== -->
<section class="flavoriz-section" style="margin-top: var(--spacing-lg);">
    <!-- Page Header -->
    <div style="max-width: 1400px; margin: 0 auto; padding: 0 var(--spacing-lg); margin-bottom: var(--spacing-xl);">
        <div style="display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: var(--spacing-md); margin-bottom: var(--spacing-lg);">
            <div>
                <h1 style="font-size: 48px; font-weight: 800; color: var(--color-black); margin-bottom: var(--spacing-sm);">Recherche</h1>
                <div style="display: flex; align-items: center; gap: 8px; color: var(--text-gray); font-size: 14px;">
                    <a href="{%url 'home:index'%}" style="color: var(--text-gray); text-decoration: none;">Accueil</a>
                    <span>/</span>
                    <span style="color: var(--color-orange);">Recherche</span>
                </div>
            </div>
        </div>
        
        <!-- Search Form -->
        <div style="max-width: 600px; margin: 0 auto var(--spacing-xl);">
            <form action="{% url 'products:product-search'%}" method="post" style="display: flex; gap: var(--spacing-sm); background: var(--color-white); border-radius: var(--radius-lg); padding: 12px; box-shadow: var(--shadow-sm);">
                {% csrf_token %}
                <input name="search-product" type="text" placeholder="Rechercher un produit..." autocomplete="off" required style="flex: 1; border: none; outline: none; font-size: 14px; padding: 8px;" />
                <button type="submit" style="background: var(--color-orange); color: white; border: none; border-radius: var(--radius-md); padding: 8px 20px; cursor: pointer; font-size: 16px;">
                    <i class="fi-rs-search"></i>
                </button>
            </form>
        </div>
        
        <!-- Results Count -->
        <div style="text-align: center; margin-bottom: var(--spacing-lg);">
            {% if request.session.search_product %}
            <p style="font-size: 16px; color: var(--text-gray);">
                Nous avons trouvé <strong style="color: var(--color-orange);">{{ request.session.products_count }}</strong> article(s) pour <strong style="color: var(--color-orange);">"{{ request.session.search_product }}"</strong>
            </p>
            {% else %}
            <p style="font-size: 16px; color: var(--text-gray);">Recherchez un produit par nom...</p>
            {% endif %}
        </div>
    </div>

    <!-- Products Grid -->
    <div style="max-width: 1400px; margin: 0 auto; padding: 0 var(--spacing-lg);">
        {% if qs %}
        <div id="products-list" class="flavoriz-product-grid">
            {% for product in qs %}
            <div class="flavoriz-product-card" style="cursor: pointer;" onclick="window.location.href='{% url 'products:product-details' product.PRDSlug %}'">
                <div style="position: relative;">
                    <img src="{{product.product_image.url}}" alt="{{product.product_name}}" class="flavoriz-product-image" />
                    {% if product.promotional == 'Hot' %}
                    <span style="position: absolute; top: 8px; left: 8px; background: var(--color-orange); color: white; padding: 4px 12px; border-radius: var(--radius-sm); font-size: 11px; font-weight: 600;">Hot</span>
                    {% elif product.promotional == 'New' %}
                    <span style="position: absolute; top: 8px; left: 8px; background: #10b981; color: white; padding: 4px 12px; border-radius: var(--radius-sm); font-size: 11px; font-weight: 600;">New</span>
                    {% endif %}
                </div>
                <div class="flavoriz-product-body">
                    <div class="flavoriz-product-views">
                        <i class="fi-rs-eye"></i>
                        <span>{{product.view_count|default:0}}+ vues</span>
                    </div>
                    <h3 class="flavoriz-product-title">{{product.product_name}}</h3>
                    <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 12px;">
                        <span style="font-size: 18px; font-weight: 700; color: var(--color-orange);">{{product.PRDPrice|floatformat:0}} XOF</span>
                        {% if product.PRDDiscountPrice %}
                        <span style="font-size: 13px; color: var(--text-light); text-decoration: line-through;">{{product.PRDDiscountPrice|floatformat:0}} XOF</span>
                        {% endif %}
                    </div>
                    <button class="flavoriz-product-card-btn" onclick="event.stopPropagation(); window.location.href='{% url 'products:product-details' product.PRDSlug %}'">
                        <i class="fi-rs-eye"></i>
                        <span>Voir le produit</span>
                    </button>
                </div>
            </div>
            {% endfor %}
        </div>
        
        <!-- Pagination -->
        {% if qs.has_other_pages %}
        <div style="display: flex; justify-content: center; align-items: center; gap: 8px; margin-top: var(--spacing-2xl); margin-bottom: var(--spacing-xl);">
            {% if qs.has_previous %}
            <a href="?page={{qs.previous_page_number}}" style="padding: 10px 16px; background: var(--color-white); border: 1px solid var(--color-border); border-radius: var(--radius-md); color: var(--text-dark); text-decoration: none; transition: all 0.2s ease;">
                <i class="fi-rs-arrow-small-left"></i>
            </a>
            {% endif %}
            <span style="padding: 10px 16px; background: var(--color-orange); color: white; border-radius: var(--radius-md); font-weight: 600;">{{qs.number}}</span>
            {% if qs.has_next %}
            <a href="?page={{qs.next_page_number}}" style="padding: 10px 16px; background: var(--color-white); border: 1px solid var(--color-border); border-radius: var(--radius-md); color: var(--text-dark); text-decoration: none; transition: all 0.2s ease;">
                <i class="fi-rs-arrow-small-right"></i>
            </a>
            {% endif %}
        </div>
        {% endif %}
        {% else %}
        <div style="text-align: center; padding: var(--spacing-2xl);">
            <i class="fi-rs-search" style="font-size: 64px; color: var(--text-light); margin-bottom: var(--spacing-md);"></i>
            <p style="font-size: 18px; color: var(--text-gray);">Aucun produit trouvé. Essayez une autre recherche.</p>
        </div>
        {% endif %}
    </div>
</section>
{%endblock body%}
